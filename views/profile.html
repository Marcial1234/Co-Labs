{% extends "layouts/main.html" %}

{% block maincontent %}
	<style type="text/css">
		.rigid { width: 330px; }
		.box { height: initial }
		.right-indent-lg { margin-right: 100px; }
		.left-indent-lg { margin-left: 100px; }
		.left-indent-sm { margin-left: 10px; }
		.labs { font-size: large; }
		.close:hover { opacity: 1; color: red; }
	</style>

	<div class="container">
		<h2 class="text-right">
			<img class="circle gravatar" src="{{local_user.gravatarize()}}">
			{{local_user.name}} {{local_user.last_name}}
		</h2>
		<br/>
		<br/>
		<div class="box form-control pull-left left-indent-lg rigid">
			<h3 class="text-center">Open Lab Sessions</h3>
			{% if labs %}
				{% for lab in labs %}
						<div>
							<a href="{{lab.lab_link()}}" class="labs">{{lab.name}}</a>
							<i class="fa fa-search-plus pull-right tooltips" title="Details" data-toggle="collapse" href="#{{lab.key.id()}}"></i>
						</div>
						<div id="{{lab.key.id()}}" class="panel-collapse collapse">
							<div class="left-indent-sm">
							<div>
								Delete: 
								<form action="/delete_lab" method="post" class="pull-right">
									<input type="hidden" name="id" value="{{lab.key.id()}}">
									<button type="submit" class="close"><span>&times;</span></button>
								</form>
								<div style="clear:both;"></div>
								{% if lab.collaborators[2] %}
									Collaborators: 
									<br />
									<div class="left-indent-sm">
										{% for collaborator in lab.collaborators %}
											{% if collaborator != local_user.email_address %}
												<a href="{{collaborator}}">{name} {{collaborator}}</a>
												<br />
											{% endif %}
										{% endfor %}
									</div>
								{% endif %}
							</div>
						</div>
					</div>
				{% endfor %}
			{% else %}
				<div class="text-center">You do not have any open labs</div>
			{% endif %}
		</div>
		<div class="box form-control pull-right text-center right-indent-lg rigid">
			<h3>New Lab</h3>
			<form action="/new_lab" method="post" data-parsley-validate>
				<input name="emails" placeholder="Collaborators' Email" required class="form-control" type="text">
				<br />
				<input name='name' placeholder='Lab Name' type="text" required class="form-control">
				<br />
				Private? <input style="vertical-align: top;" name='private' type='checkbox' value='false'>
				<br />
				<input name='owner' type='hidden' value='{{user.email_address}}'>
				<br />
				<button class="btn btn-success" type="submit">Create New</button>
			</form>
		</div>
		<div style="clear:both;"></div>
	</div>

	<script type="text/javascript">
		$(document).ready(function () {
			$(".tooltips").tooltip();
			$(".fa").click(function () {
				$(this).toggleClass("fa-search-plus").toggleClass("fa-search-minus")
			});
		})
	</script>

{% endblock %}